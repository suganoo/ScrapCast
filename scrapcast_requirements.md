### 📝 Markdown保存フォーマットの仕様

以下の形式でGitHubリポジトリのMarkdownファイルに追記される：

```markdown
### ChatGPTによる自動コードレビュー実験
ChatGPTを活用してGitHubのPRレビューを自動化。精度と作業効率が向上した。
https://twitter.com/ユーザー名/status/ツイートID
- https://github.com/example/repo
- https://zenn.dev/sample/article
```

#### フォーマット要素：
- `### タイトル行`: 元ツイートの内容からAIが生成する簡潔なタイトル（最大15〜20文字程度）
- 次の行：元ツイートの要約（1〜2文）
- 次の行：ツイートリンク（Twitter URL）
- 次の行：ツイート内に含まれていたその他の外部リンク（最大数件までリスト形式）

#### ルール：
- 行間は空けない
- `要約:` や `リンク:` などのラベルは使わない
- Markdown内の構文を破壊しないようURL等は生のまま記載
- 複数の参考URLがあればハイフン（`- `）付きでリストにする

この形式により、情報の視認性とGitHubでの履歴管理・内容整理が容易になる。

---

### 💬 ツイートへの返信仕様

ScrapCastが保存処理を完了したら、メンション付きツイートに対してリプライを送信する。

#### リプライ内容：
- 「保存完了」のメッセージ
- GitHubで更新されたMarkdownファイルのリンクを含める

#### メッセージ例：
```
✅ 保存しました！
こちらに追加しました👇
https://github.com/ユーザー名/リポジトリ名/blob/main/x_notes.md
```

### 🔐 Secrets管理について

ScrapCastでは、外部API（GitHub、Twitter）との安全な連携のために、シークレット情報（認証キーやトークンなど）を環境変数として安全に管理する必要がある。

#### 管理対象の例：
| シークレット名         | 用途                                |
|--------------------------|-------------------------------------|
| `GITHUB_CLIENT_ID`       | GitHub OAuth認証用のクライアントID |
| `GITHUB_CLIENT_SECRET`   | GitHub OAuth認証用のシークレット    |
| `TWITTER_BEARER_TOKEN`   | Twitter APIアクセス用トークン       |
| `JWT_SECRET`             | Webアプリのセッション署名用秘密鍵   |

#### Render.com での管理方法：
- 管理画面 > 対象のサービス > Environment タブを開く
- 必要なキーと値を入力（暗号化されて保存）
- アプリケーション内では `os.environ["KEY"]` のように読み出し
- サーバー再起動時にも自動で反映される

#### セキュリティ上の注意：
- これらは絶対にソースコードに直接書かないこと
- GitHubリポジトリにも含めないこと（.envファイルなどは除外）
- トークン漏洩の防止とアクセス制御のため、必要最小限の範囲で使用する

---

#### 補足：
- ユーザーによってリポジトリやファイル名が異なるため、動的にリンクを生成する
- リプライは元メンションツイートに対して直接送信
- 失敗時はエラーメッセージや再試行ログを残す

---

### 🏗 インフラ構成（低コスト・MVP向け）

ScrapCastは、コストを抑えながら安定して動作するインフラ構成を採用する。

#### 構成要素：
| 機能        | サービス        | プラン/料金        | 備考 |
|-------------|------------------|---------------------|------|
| Web UI/API  | Render.com または Fly.io | 無料枠あり（月数百円以下） | Node.js / Python 対応 |
| DB（設定管理用） | Cloud Firestore（Firebase） | 無料枠で十分 | スキーマレス・シンプル |
| Polling処理 | GitHub Actions（cron） | 無料（パブリックRepo前提） | 定期実行可能、シンプル構成 |
| OAuth連携 | Render/Fly内で対応 | - | 認証・リダイレクト処理対応 |
| Secrets管理 | Render/Fly/Actionsに内蔵 | - | APIトークンを安全に保持 |

#### ポイント：
- GitHub Actionsのcronを使えば、常駐プロセスなしでPollingを実現
- Firestoreは5万読み取り/月・1GBストレージまで無料で十分
- RenderやFly.ioは無料で常時稼働可能（低負荷アプリ前提）

#### 補足：
- 一定のユーザー数を超えたら有料プラン or クラウド移行も検討
- GitHub Actionsの使用時間（2,000分/月）に注意

